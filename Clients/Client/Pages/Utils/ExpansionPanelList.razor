@using System.Collections.ObjectModel
@typeparam TItem

<MatHidden BreakPoint="@MatBreakpoint.SM" Direction="@MatHiddenDirection.Up">
    <ChildContent>
         <MatAccordion Multi="true">
            @*Why Virtualize is not working????*@

            @*<Virtualize Items="@Items">
                       <ExpansionPanel HeaderTemplate="@HeaderTemplate(@context)" BodyTemplate="@BodyTemplate(@context)"/>
                   </Virtualize>*@

            @foreach (var item in Items) //TODO replace with virtualize
            {
                <ExpansionPanel HeaderTemplate="@HeaderTemplate(item)" BodyTemplate="@BodyTemplate(item)"/>
            }
        </MatAccordion>
    </ChildContent>

    <ElseContent>
        <WrapPanel>
            @foreach (var item in Items) //TODO replace with virtualize
            {
                <Card CardHeader="@HeaderTemplate(item)" CardContent="@BodyTemplate(item)" />
            }
        </WrapPanel>
    </ElseContent>
</MatHidden>

@code {
    
    [Parameter]
    public ObservableCollection<TItem> Items { get; set; }

    [Parameter]
    public RenderFragment<TItem> HeaderTemplate  { get; set; }

    [Parameter]
    public RenderFragment<TItem> BodyTemplate { get; set; }

}